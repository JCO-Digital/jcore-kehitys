name: Deploy site

on:
  push:
    branch:
      - main

jobs:

  build:
    uses: jco-digital/deploy-wp-action/.github/workflows/build-project.yml@main
    with:
      platform: ubuntu-latest
      fetch_submodules: true
      php_version: 8.2
      slack_channel: CU8LPT03W
    secrets: inherit
  deploy:
    needs: [ build ]
    uses: jco-digital/deploy-wp-action/.github/workflows/server-deploy.yml@main
    with:
      platform: ubuntu-latest
      server_url: saalastigroupvc@vc.bojaco.com
      base_path: /sites/saalastigroup.com/files
      paths: >-
        wp-content/themes/ilme/:wp-content/themes/ilme/,
        modules/:modules/,
        vendor/:vendor/
      known_hosts: ${{ vars.VC_HOSTS }}
      slack_channel: CU8LPT03W
    secrets: inherit